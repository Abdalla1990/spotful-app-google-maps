export var SpotfulAppCommunicationApi=function(){if(void 0!=SpotfulAppCommunicationApi.instance)return SpotfulAppCommunicationApi.instance;SpotfulAppCommunicationApi.instance=this;var e={context:"bespotful.com",version:"0.0.1"},n={update:[],show:[],hide:[]};this.ready=function(){i("ready",{events:[],methods:[]})},this.addEventListener=function(e,t){if(void 0==n[e])throw"Could not recognize event key: "+e;if("function"!=typeof t)throw"Second Parameter must be a function";return n[e].length<=0&&"ready"!=e&&o({method:"addEventListener",value:e}),n[e].push(t),t},this.removeEventListener=function(e,t){if(void 0==n[e])throw"Could not recognize event key : "+e;if("function"==typeof t)throw"Second Parameter must be a function";var o=n[e].indexOf(t);n[e].splice(o,1)};var t=function(){var e={};return window.location.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(n,t,o,i){e[t]=i}),e},o=function(n){if("object"!=typeof n)throw"Could not recognize the payload";n.id=e.id,n.context=e.context,n.version=e.version;var t=JSON.stringify(n);window.parent.postMessage(t,"*")},i=function(e,n){o(n={event:e,value:n})},a=function(e,t){if(void 0!=n[e]||"array"!=typeof n[e])for(var o in n[e])n[e][o](t)},p=function(n){if(void 0!=n.data){var t;try{t=JSON.parse(n.data)}catch(e){console.log("Unhandled message!")}"object"==typeof t&&void 0!=t.context&&t.context==e.context&&(void 0!=t.event&&a(t.event,t),t.method)}else console.warn("Data is not present in payload")};!function(e){var n=t();if(void 0==n.id||"string"!=typeof n.id)throw"No ID provided. Please make sure that a proper ID has been provided to your app.";e.id=n.id,window.addEventListener("message",p)}(e)};new SpotfulAppCommunicationApi,SpotfulAppCommunicationApi.addEventListener=SpotfulAppCommunicationApi.instance.addEventListener,SpotfulAppCommunicationApi.removeEventListener=SpotfulAppCommunicationApi.instance.removeEventListener,SpotfulAppCommunicationApi.ready=SpotfulAppCommunicationApi.instance.ready;